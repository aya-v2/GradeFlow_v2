{% extends "base.html.twig" %}

{% block title %}Archives des Classes{% endblock %}

{% block body %}
    {% include 'components/sidebar.html.twig' %}

    <main class="min-h-screen p-8 bg-white">
        <div class="max-w-7xl mx-auto">
            <div class="flex items-center justify-between mb-8">
                <div>
                    <h1 class="text-4xl font-bold text-gray-900">Archives des Classes</h1>
                    <p class="text-sm text-gray-600 mt-2">Classes des années scolaires antérieures</p>
                </div>
                <a href="{{ path('app_admin_classes') }}" class="inline-flex items-center gap-2 px-6 py-3 bg-indigo-600 text-white rounded-lg hover:bg-indigo-700 transition font-bold">
                    <svg class="w-5 h-5" fill="none" viewBox="0 0 24 24" stroke="currentColor" style="width: 16px; height: 16px;">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M15 19l-7-7 7-7" />
                    </svg>
                    Retour aux Classes Courantes
                </a>
            </div>

            {% if archivedYears is empty %}
                <div class="bg-blue-50 border border-blue-200 rounded-2xl px-6 py-8 text-center">
                    <p class="text-blue-800 font-medium">Aucune classe archivée</p>
                    <p class="text-blue-700 text-sm mt-1">Les classes des années scolaires antérieures apparaîtront ici</p>
                </div>
            {% elseif filieres is empty %}
                <div class="bg-amber-50 border border-amber-200 rounded-2xl px-6 py-8 text-center">
                    <p class="text-amber-800 font-medium">Aucune filière disponible</p>
                </div>
            {% else %}
                {% for filiere in filieres %}
                    <div class="mb-8">
                        <h2 class="text-2xl font-bold text-gray-900 mb-4">{{ filiere.name }}</h2>
                        
                        {% if classesByFiliere[filiere.id] is empty %}
                            <div class="bg-slate-50 border border-slate-200 rounded-2xl px-6 py-8 text-center">
                                <p class="text-slate-600">Aucune classe archivée pour cette filière</p>
                            </div>
                        {% else %}
                            <div class="bg-white rounded-2xl shadow-sm border border-slate-100 overflow-hidden">
                                <div class="overflow-x-auto">
                                    <table class="w-full">
                                        <thead class="bg-slate-50 border-b border-slate-100">
                                            <tr>
                                                <th class="px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wide">Nom</th>
                                                <th class="px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wide">Niveau</th>
                                                <th class="px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wide">Année</th>
                                                <th class="px-6 py-3 text-left text-xs font-bold text-slate-600 uppercase tracking-wide">Étudiants</th>
                                                <th class="px-6 py-3 text-center text-xs font-bold text-slate-600 uppercase tracking-wide">Actions</th>
                                            </tr>
                                        </thead>
                                        <tbody class="divide-y divide-slate-100">
                                            {% for classe in classesByFiliere[filiere.id] %}
                                            <tr class="hover:bg-slate-50 transition">
                                                <td class="px-6 py-4 text-gray-900 font-medium">{{ classe.name }}</td>
                                                <td class="px-6 py-4">
                                                    <span class="inline-block px-3 py-1 bg-indigo-100 text-indigo-700 rounded-full text-xs font-bold">
                                                        L{{ classe.level }}
                                                    </span>
                                                </td>
                                                <td class="px-6 py-4 text-gray-700">
                                                    <span class="text-gray-500 italic">{{ classe.schoolYear.name }}</span>
                                                </td>
                                                <td class="px-6 py-4 text-gray-700">{{ classe.students | length }}</td>
                                                <td class="px-6 py-4 text-center">
                                                    <a href="{{ path('app_admin_classe_edit', { id: classe.id }) }}" class="text-indigo-600 hover:text-indigo-700 font-medium text-sm">
                                                        Consulter
                                                    </a>
                                                </td>
                                            </tr>
                                            {% endfor %}
                                        </tbody>
                                    </table>
                                </div>
                            </div>
                        {% endif %}
                    </div>
                {% endfor %}
            {% endif %}
        </div>
    </main>

    {% include 'components/sidebar_close.html.twig' %}
{% endblock %}
